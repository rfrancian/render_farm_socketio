<html>

<head>
  <title>Render Farm Manager v001</title>
  <link rel="stylesheet" href="/stylesheets/style.css">

  <title>Socket.IO chat</title>

</head>

<body>
  <h1>Render farm v001</h1>
  <p>Welcome to render farm</p>


  <section class="container">
    <form id="my-form">
      <h1>Render Information:</h1>

      <div>
        <label for="filename"> filename:</label>
        <input type="text" value='/Volumes/blenderFiles/input/' id="filename">
      </div>
      
      <div class="nodeFields">
        <div>
          <label for="workerNode1"> workerNode1 :</label>
          <input type="text" value = 'rsf@192.168.86.20' id="workerNode1">
        </div>
        <div>
          <label for="workerNode2"> workerNode2 :</label>
          <input type="text" value = 'rsf@192.168.86.41' id="workerNode2">
        </div>
        <div>
          <label for="workerNode3"> workerNode3 :</label>
          <input type="text" value = 'rsf@0.0.0.0' id="workerNode3">
        </div>
        <div>
          <label for="workerNode4"> workerNode4 :</label>
          <input type="text" value = 'rsf@0.0.0.0' id="workerNode4">
        </div>

      </div>     

      <div class="nodeFields">
          <div>
            <label for="workerNode5"> workerNode5 :</label>
            <input type="text" value = 'rsf@0.0.0.0' id="workerNode5">
          </div>
          <div>
            <label for="workerNode6"> workerNode6 :</label>
            <input type="text" value = 'rsf@0.0.0.0' id="workerNode6">
          </div>
          <div>
            <label for="workerNode7"> workerNode7 :</label>
            <input type="text" value = 'rsf@0.0.0.0' id="workerNode7">
          </div>
          <div>
            <label for="workerNode8"> workerNode8 :</label>
            <input type="text" value = 'rsf@0.0.0.0' id="workerNode8">
          </div>
  
        </div>     
  

      <div class="intFields">
        <div>
          <label for="seed"> seed :</label>
         <input type="text" value = '0' id="seed">
        </div>
        <div>
          <label for="samples"> samples:</label>
          <input type="text" value = '4' id="samples">
        </div>
        <div>    
          <label for="split"> split:</label>
          <input type="text" value = '4' id="split">
        </div>
      </div>

      <div class="msg"></div>    <div class="timeStamp"></div>

      <div>
          <label for="Node1"> Node 1: </label>
          <textarea id="Node1" rows='10' cols= '122'></textarea>
      </div>
      <div>
          <label for="Node2"> Node 2:</label>
          <textarea id="Node2" rows='10' cols= '122'></textarea>
      </div>
      <input class="btn" type="submit" value="Submit">
    </form>


    <ul id="users"></ul>


  </section>
  
  <ul id='messages'></ul>

<script src="/socket.io/socket.io.js"></script>
<script>

  
    var startTime =  Date.now()

    var socket = io();

    const myForm = document.querySelector('#my-form')
    const filenameInput = document.querySelector('#filename')
    const seedInput = document.querySelector('#seed')
    const msg = document.querySelector('.msg')
    const timeStamp = document.querySelector('.timeStamp')

    const samplesInput = document.querySelector('#samples')
    const splitInput = document.querySelector('#split')

    const Node1Input = document.querySelector('#Node1')
    const Node2Input = document.querySelector('#Node2')
    
    var workerNodeInput = [ document.querySelector('#workerNode1').value, 
                            document.querySelector('#workerNode2').value, 
                            document.querySelector('#workerNode3').value, 
                            document.querySelector('#workerNode4').value, 
                            document.querySelector('#workerNode5').value, 
                            document.querySelector('#workerNode6').value, 
                            document.querySelector('#workerNode7').value, 
                            document.querySelector('#workerNode8').value]
                            
    // const workerNodeInput[1] = document.querySelector('#workerNode2')
    // const workerNodeInput = document.querySelector('#workerNode3')
    // const workerNodeInput = document.querySelector('#workerNode4')


    myForm.addEventListener('submit', onSubmit)

    function onSubmit(e) {
      e.preventDefault()
      console.log(filenameInput.value)
      console.log(workerNodeInput)
      startTime = Date.now()
      socket.emit('filename', [filenameInput.value, samplesInput.value, splitInput.value, workerNodeInput, seedInput.value])
      socket.emit('samples', samplesInput.value)
      socket.emit('split', splitInput.value)
      msg.innerHTML = ` file name: ${filenameInput.value}  `
      return false;
    }

    socket.on('node1Message', function(msg) {
      Node1Input.value += msg + '' + '\n'
      Node1Input.scrollTop = Node1Input.scrollHeight
      timeStamp.innerHTML = ` elapsed time :  ${(Date.now()-startTime)/1000} seconds`

    })
    socket.on('node2Message', function(msg) {
      Node2Input.value += msg + '' + '\n'
      Node2Input.scrollTop = Node2Input.scrollHeight
      timeStamp.innerHTML = ` elapsed time :  ${(Date.now()-startTime)/1000} seconds`

    })


</script>

</body>

</html>
